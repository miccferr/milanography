function stampoSuFile(a){shape_to_txt=JSON.stringify(a,null,"	");var b=new Blob([shape_to_txt],{type:"text/plain;charset=utf-8"});return b}var map=L.map("map").setView([-41.2858,174.78682],14);mapLink='<a href="http://openstreetmap.org">OpenStreetMap</a>',L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; "+mapLink+" Contributors",maxZoom:18}).addTo(map);var LeafIcon=L.Icon.extend({options:{shadowUrl:"http://leafletjs.com/docs/images/leaf-shadow.png",iconSize:[38,95],shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-76]}}),greenIcon=new LeafIcon({iconUrl:"http://leafletjs.com/docs/images/leaf-green.png"}),drawnItems=new L.FeatureGroup;map.addLayer(drawnItems);var drawControl=new L.Control.Draw({position:"topright",draw:{polygon:{shapeOptions:{color:"purple"},allowIntersection:!1,drawError:{color:"orange",timeout:1e3},showArea:!0,metric:!1,repeatMode:!0},polyline:{shapeOptions:{color:"red"}},rect:{shapeOptions:{color:"green"}},circle:{shapeOptions:{color:"steelblue"}},marker:{icon:greenIcon}},edit:{featureGroup:drawnItems}});map.addControl(drawControl),map.on("draw:created",function(a){$("#data").val(" ");var b=a.layerType,c=a.layer;"marker"===b&&c.bindPopup("A popup!"),drawnItems.addLayer(c);var d=(c.toGeoJSON(),drawnItems.toGeoJSON());$("#data").val(JSON.stringify(d,null,"	")),stampoSuFile(drawnItems.toGeoJSON())}),stampoSuFile(drawnItems.toGeoJSON());